---
import { type CollectionEntry, getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Slide from "../../components/Slide.astro";

export async function getStaticPaths() {
  const slides = await getCollection("slides");

  return slides.map((slide) => ({
    params: { slug: slide.slug },
    props: slide,
  }));
}

type Props = CollectionEntry<"slides">;

const slide = Astro.props;
const { Content } = await slide.render();

const slides = await getCollection("slides");
const slideIndex = slides.findIndex((c) => c.slug === slide.slug);
const prev = slideIndex > 0 ? slides[slideIndex - 1].slug : "";
const next = slideIndex < slides.length - 1 ? slides[slideIndex + 1].slug : "";
---

<Layout title={`Nook2024: ${slide.data.title}`}>
  <Slide prev={prev} next={next}>
    <Content />
  </Slide>
</Layout>
